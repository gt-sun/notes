[TOC]


## 爬`4chan.org`的图片url

```go
package main

import (
    "fmt"
    "io/ioutil"
    "log"
    "net/http"
    "regexp"
)

const (
    url = "http://boards.4chan.org/s/"
)

var (
    imgurlExp = regexp.MustCompile(`src="//i\.4cdn\.org/s/[0-9]+s\.jpg"`)
)

func downfromurl(url string) string {
    resp, err := http.Get(url)
    check(err)
    defer resp.Body.Close()
    data, err := ioutil.ReadAll(resp.Body)
    check(err)
    return string(data)
}

func main() {

    // c := make(chan bool)
    pagedata := downfromurl(url)
    urls := imgurlExp.FindAllString(pagedata, 10)
    fmt.Println(len(urls))
    for _, url := range urls {
        parseUrl(url)
    }
}

func parseUrl(url string) {
    c := make(chan bool)
    go func(url string, c chan bool) {
        fmt.Println(url[7 : len(url)-1])

        c <- true
    }(url, c)

    <-c

}

func check(err error) {
    if err != nil {
        log.Fatal(err)
    }
}

```