
[TOC]


## 消息队列

- Kafka 与 Flume 的区别

Kafka 与 Flume 很多功能确实是重复的。以下是评估两个系统的一些建议：

Kafka 是一个通用型系统。你可以有许多的生产者和消费者分享多个主题。相反地，Flume 被设计成特定用途的工作，特定地向 HDFS 和 HBase 发送出去。Flume 为了更好地为 HDFS 服务而做了特定的优化，并且与 Hadoop 的安全体系整合在了一起。基于这样的结论，Hadoop 开发商 Cloudera 推荐如果数据需要被多个应用程序消费的话，推荐使用 Kafka，如果数据只是面向 Hadoop 的，可以使用 Flume。

Flume 拥有许多配置的来源 (sources) 和存储池 (sinks)。然后，Kafka 拥有的是非常小的生产者和消费者环境体系，Kafka 社区并不是非常支持这样。如果你的数据来源已经确定，不需要额外的编码，那你可以使用 Flume 提供的 sources 和 sinks，反之，如果你需要准备自己的生产者和消费者，那你需要使用 Kafka。

Flume 可以在拦截器里面实时处理数据。这个特性对于过滤数据非常有用。Kafka 需要一个外部系统帮助处理数据。

无论是 Kafka 或是 Flume，两个系统都可以保证不丢失数据。然后，Flume 不会复制事件。相应地，即使我们正在使用一个可以信赖的文件通道，如果 Flume agent 所在的这个节点宕机了，你会失去所有的事件访问能力直到你修复这个受损的节点。使用 Kafka 的管道特性不会有这样的问题。

Flume 和 Kafka 可以一起工作的。如果你需要把流式数据从 Kafka 转移到 Hadoop，可以使用 Flume 代理 (agent)，将 kafka 当作一个来源 (source)，这样可以从 Kafka 读取数据到 Hadoop。你不需要去开发自己的消费者，你可以使用 Flume 与 Hadoop、HBase 相结合的特性，使用 Cloudera Manager 平台监控消费者，并且通过增加过滤器的方式处理数据。

## TensorFlow

[深度学习利器：分布式 TensorFlow 及实例分析](http://mp.weixin.qq.com/s?__biz=MzI4MjE3MTcwNA==&mid=2664335065&idx=1&sn=d5a71c8219b684e266e1339ee9a39b8c&chksm=f0a4268ec7d3af983f2aaa86af648aa1449f8bb2c2e2722ba9987935b3c48ad9ff236581134e#rd)


## 支付是否需要对接N多银行？

Q：支付的这个需要对接多个银行么？

A：需要，我们现在对接了快 10 个银行，还在对接更多的银行。除了银行，第三方支付、外卡等，也都在接。


## 关于数据库

Q：Hbase 和 mongo 读写分离这块能具体说一下嘛？ 和 mongo 副本集比较有啥优势么？

A：这个问题就是涉及到如何使用数据库的问题。每个数据库都有自己的优势，比如 HBase 写入性能极好，上万的 TPC 都没问题，但是读取的性能就差了，就小几千。 Couchbase 读取的性能极佳，但是写入就很一般。 Redis 读写都很不错，就是不能支持太大粒度的数据，以及容量有限制。 MongoDB 似乎比较尴尬，功能很全面，但是读写都一般。

## 关于微服务

Q：微服务是按表来拆分的，那么是一个服务自己连一个数据库还是有统一得数据层呢？

A：RPC 层的微服务，基本是按表来拆分了，自己连一个数据库。这里实际也分两层，数据访问层和业务逻辑层。如果业务逻辑很薄，就合并成一层了。

Q：RPC 为什么不用国产 Dubbo 啊？

A：这是个好问题，我们经常被问这个问题。 Dubbo 是个不错的框架，相对微服务来说，还是太重了。 而且，性能上，比 Thrift 还是要差不少。 所以我们就直接上 Thrift 了。

Q：用 Thrift 做 RPC，服务发现也是自己做的吗？

A：是的，这个用 Apache Curator 比较容易实现，我们就自己搞一个。


## 服务网关

Q：服务网关使用 Nginx + Lua 方案有考虑过吗？

A：有，我第二个项目就用这个方案来做，正在做。

Q：服务网关重点需要关注那些点？

A：我们实际有两个网关，一个是对外的 Web 接口服务网关，关注的是 Load Balance 以及可靠性。 特别是服务重启的时候，网关要提前解除注册，重启之后，网关要延后注册上。 这有不少成熟的组件可以用，不一定像我们这样自己开发。 RPC 网关，也是要注意稳定性和性能，以及网关决不能和业务耦合。

## jar包的管理

Q：我有个问题，你们这个项目一定有很多微服务的 jar 包，这是 jar 包在服务器上是怎么分布的？

A：对 Web 接口类型的微服务，其实和普通的项目一样，每个项目就管自己的 jar 包以及它所依赖的 jar 包。 也有人会把所有的 jar 包汇总起来打成一个大 jar 包，这种方式，容易出现资源文件被覆盖的情况，也不容易更新，不推荐。